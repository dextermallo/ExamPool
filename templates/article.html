<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="shortcut icon" href="data:image/x-icon;," type="image/x-icon">
        <title>Index</title>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
        <!-- Theme included stylesheets -->
        <link href="//cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
        <link href="//cdn.quilljs.com/1.3.6/quill.bubble.css" rel="stylesheet">


    </head>
    <body>
        {% include 'nav.html' %}
        {% load widget_tweaks %}
        {% load index %}
        
        <div class = "container text-center">
            <div class = "justify-content-center w-100">
                <div>
                    <a>
                        標題 : {{Article.title}}
                    </a>
                    <a>
                        作者 : {{Article.author}}
                    </a>
                    <a>
                        時間 : {{Article.post_date}}
                    </a>
                    <a>
                        {{ article_goodbad_count }}
                    </a>
                    <form class="btn-group" role="group" method = "POST">
                        <button type=
                            {% if user.is_authenticated %}
                            "submit"
                            {% else %}
                            "button"
                            {% endif %}
                            name = "goodbad" value = "good" class="btn btn-secondary ">
                            <i class="fas fa-thumbs-up"></i>
                        </button>
                        <button type=
                            {% if user.is_authenticated %}
                            "submit"
                            {% else %}
                            "button"
                            {% endif %}
                            name = "goodbad" value = "bad" class="btn btn-secondary">
                            <i class="fas fa-thumbs-down"></i>
                        </button>
                        <input type="hidden" name = "is_article" value = "True">
                        <input type="hidden" name = "comment_id" value = "0">
                    </form>
                    {% if user.username == Article.author %}
                    <a href = "{{Article.id}}/deleteArticle" class ="btn">delete</a>
                    <a href = "{{Article.id}}/reviseArticle" class ="btn">revise</a>
                    {% endif %}
                </div>
                {{Article.content|safe}}
            </div>

            <a href = {{Article.id}} class = "btn btn-success w-50 mt-3">
                留言區
            </a>
            
            {% if user.is_authenticated %}
            <form class="btn-group" role="group" method = "POST">
                <button type = "submit" name = "article_id" value = {{Article.id}} class="btn btn-secondary">add favorite</button>
            </form>
            {% endif %}

            {% if user.is_authenticated %}
            <a href = "{{Article.id}}/reply" class="btn btn-secondary">reply</a>
            {% endif %}

            <div>
                {% for comment in Comment %}
                <div>
                    {% if comment.exist %}
                        #{{comment.id}}
                        {{comment.author}}
                        {% if comment.parent_comment_id != 0%}
                            {{'>> #'}}
                            {{comment.parent_comment_id}}
                        {% endif %}
                        :
                        {{comment.content|safe}}
                        <a>
                            {{ comment_goodbad_count|index:forloop.counter0 }}
                        </a>
                        <form class="btn-group" role="group" method = "POST">
                            <button type=
                                {% if user.is_authenticated %}
                                    "submit"
                                {% else %}
                                    "button"
                                {% endif %}
                            name = "goodbad" value = "good" class="btn btn-secondary">good</button>
                            <button type=
                                {% if user.is_authenticated %}
                                    "submit"
                                {% else %}
                                    "button"
                                {% endif %}
                            name = "goodbad" value = "bad" class="btn btn-secondary">bad</button>
                            <input type="hidden" name = "comment_id" value = {{comment.id}}>
                            <input type="hidden" name = "is_article" value = "False">
                            {% if user.username == comment.author %}
                                <a href = "{{Article.id}}/{{comment.id}}/deleteComment" class ="btn">delete</a>
                            {% endif %}
                            {% if user.is_authenticated %}
                                <a href = "{{Article.id}}/reply/{{comment.id}}" class ="btn">reply</a>
                            {% endif %}
                        {% endif %}
                    </form>
                </div>
                {% endfor %}
            </div>
        </div>
    </body>
</html>